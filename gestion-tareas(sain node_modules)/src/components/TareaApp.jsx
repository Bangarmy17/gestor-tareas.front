import { useEffect, useState } from "react";
import { listTarea } from "../services/TareaService";
import { TareaGrid } from "./TareaGrid";
import { TareaForm } from "./TareaForm";

export const TareaApp = () => {
    const [tareas, setTareas] = useState([]);

    const [tareasSelected, setTareasSelected] = useState({
        nombre: '',
        descripcion: '',
        completada: false
    });

    useEffect(() => {
        const result = listTarea();
        setTareas(result);
    }, []);
    const handlerAddTarea = (tarea) => {
        if (tarea.id > 0) {
            setTareas(tareas.map(tar => {
                if (tar.id === tarea.id) {
                    return { ...tarea };
                }
                return tar;
            }));
        } else {
            setTareas([...tareas, { ...tarea, id: new Date().getTime() }]);
        }
    }
    const handlerRemoveTarea = (id) => {
        setTareas(tareas.filter(tarea => tarea.id != id));
    };
    const handlerTareaSelected = (tarea) => {
        setTareasSelected({...tarea });
    }
    return (
        <>
            <h1>Gestor de tareas</h1>
            <div>
                <TareaForm handlerAdd={handlerAddTarea} tareasSelected={tareasSelected} />
            </div>
            <div>
                <TareaGrid tareas={tareas} handlerRemove={handlerRemoveTarea} handlerSelected={handlerTareaSelected} />
            </div>
        </>
    )
}